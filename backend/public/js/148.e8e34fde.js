"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[148],{2148:function(t,e,s){s.r(e),s.d(e,{default:function(){return _}});var a=s(6768),i=s(4232),n=s(5130);const o={class:"grocery-container"},r={class:"grocery-list"},u={class:"grocery-details"},d={class:"food-name"},l={key:0,class:"food-quantity"},c={key:1,class:"food-quantity"},p={class:"grocery-actions"},h={key:0,class:"update-section"},m=["onUpdate:modelValue"],y=["onClick"],f=["onClick"],k={key:1,class:"non-modifiable"},q=["onClick"];function g(t,e,s,g,b,C){return(0,a.uX)(),(0,a.CE)("div",o,[e[1]||(e[1]=(0,a.Lk)("h1",null,"Ma liste des courses",-1)),(0,a.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>C.exportToFile&&C.exportToFile(...t)),class:"export-btn"},"Exporter"),(0,a.Lk)("ul",r,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(b.shoppingItems,((t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"grocery-item"},[(0,a.Lk)("div",u,[(0,a.Lk)("span",d,(0,i.v_)(t.food_name),1),t.quantity?((0,a.uX)(),(0,a.CE)("span",l,(0,i.v_)(t.quantity),1)):((0,a.uX)(),(0,a.CE)("span",c,"(pas de quantité définie)"))]),(0,a.Lk)("div",p,[t.quantity&&C.isQuantityNumeric(t.quantity)?((0,a.uX)(),(0,a.CE)("div",h,[(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":e=>b.quantities[t.food_id]=e,placeholder:"Nouvelle quantité",class:"quantity-input"},null,8,m),[[n.Jo,b.quantities[t.food_id],void 0,{number:!0}]]),(0,a.Lk)("button",{onClick:e=>C.updateQuantity(t.food_id,"add"),class:"update-btn"},"Ajouter",8,y),(0,a.Lk)("button",{onClick:e=>C.updateQuantity(t.food_id,"subtract"),class:"subtract-btn"},"Soustraire",8,f)])):t.quantity?((0,a.uX)(),(0,a.CE)("span",k)):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:e=>C.deleteItem(t.food_name),class:"delete-btn"},"Supprimer",8,q)])])))),128))])])}s(4603),s(7566),s(8721);var b=s(4373),C={name:"GroceryPage",data(){return{shoppingItems:[],quantities:{}}},methods:{async fetchShoppingList(){try{const t=await b.A.get("https://tfe-3483aa964321.herokuapp.com/shopping-list/",{withCredentials:!0});this.listId=t.data.listId,this.shoppingItems=t.data.items,this.shoppingItems.forEach((t=>{if(this.isQuantityNumeric(t.quantity)){const e=t.quantity.match(/^(\d+)/);this.quantities[t.food_id]=e?parseInt(e[1],10):0}}))}catch(t){t.response&&404===t.response.status?console.error("Aucune liste des courses trouvée :",t):console.error("Erreur lors de la récupération de la liste des courses :",t)}},exportToFile(){const t="Ma liste des courses\n\n",e=this.shoppingItems.map((t=>`- ${t.food_name} ${t.quantity?`(${t.quantity})`:""}`)).join("\n"),s=t+e,a=new Blob([s],{type:"text/plain"}),i=document.createElement("a");i.href=URL.createObjectURL(a),i.download="Ma_liste_des_courses.txt",i.click(),URL.revokeObjectURL(i.href)},async deleteItem(t){try{await b.A.delete("https://tfe-3483aa964321.herokuapp.com/shopping-list/delete",{params:{food_name:t},withCredentials:!0}),this.shoppingItems=this.shoppingItems.filter((e=>e.food_name!==t))}catch(e){console.error("Erreur lors de la suppression de l'aliment :",e)}},async updateQuantity(t,e="add"){const s=this.quantities[t];if(void 0===s||s<=0)return void alert("Veuillez entrer une quantité valide.");const a="add"===e?s:-s;try{const s=this.shoppingItems.find((e=>e.food_id===t));if(s){const t=parseInt(s.quantity.match(/^(\d+)/)[1],10);if("subtract"===e&&t+a<=0)return void alert("La quantité ne peut pas être égale à 0.")}const i=await b.A.post("https://tfe-3483aa964321.herokuapp.com/shopping-list/update-quantity",{listId:this.listId,foodId:t,incrementValue:a},{withCredentials:!0});s&&(s.quantity=i.data.newQuantity)}catch(i){console.error("Erreur lors de la mise à jour de la quantité :",i)}},isQuantityNumeric(t){return/^\d+/.test(t)}},mounted(){this.fetchShoppingList()}},I=s(1241);const v=(0,I.A)(C,[["render",g],["__scopeId","data-v-737e6806"]]);var _=v}}]);
//# sourceMappingURL=148.e8e34fde.js.map