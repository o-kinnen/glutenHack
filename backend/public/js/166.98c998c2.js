"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[166],{5711:function(e,t,i){i.r(t),i.d(t,{default:function(){return ne}});var n=i(6768),o=i(4232),a=i(5130);const s={class:"container"},r={class:"card p-4 text-white"},l={class:"buttons-container"},c={class:"modal-content"},d={class:"filter-grid"},u={class:"filter-item"},p={key:0,class:"dropdown"},h=["onClick"],f={class:"filter-item"},g={key:0,class:"dropdown"},m=["onClick"],y={class:"filter-item"},v={key:0,class:"dropdown"},w=["onClick"],k={class:"filter-item"},b={key:0,class:"dropdown"},C=["onClick"],M={class:"filter-item"},L={key:0,class:"dropdown"},x=["onClick"],I={class:"filter-item"},E={class:"action-buttons"},D={key:1,class:"loading-overlay"},T={class:"modal-content"},S={style:{"text-align":"center"}},A=["src"],R={class:"recipe-info-container"},_={class:"recipe-info-line"},P={class:"info-item"},O={class:"info-item"},F={class:"info-item"},Q={class:"recipe-info-line"},X={class:"info-item"},z={class:"info-item"},j={key:0,class:"info-item"},B={class:"modal-content"},W={style:{display:"flex","justify-content":"space-around","margin-top":"20px"}},N={class:"modal-content"},V=["value"],q=["onUpdate:modelValue","placeholder","max","disabled","onInput"],U=["onClick"],H=["onClick"],K={style:{display:"flex","justify-content":"space-around","margin-top":"20px"}};function Z(e,t,i,Z,J,Y){const $=(0,n.g2)("EditRecipe"),G=(0,n.g2)("modal");return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.Lk)("div",r,[t[34]||(t[34]=(0,n.Lk)("h1",{class:"text-white"},"Créer une nouvelle recette",-1)),t[35]||(t[35]=(0,n.Lk)("p",null,"Vous pouvez créer une recette en l'éditant ou bien la générer à l'aide d'une IA selon vos besoins.",-1)),(0,n.Lk)("div",l,[(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>Y.openIARecipeModal&&Y.openIARecipeModal(...e)),class:"button"}," Générer "),(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>Y.openEditRecipe&&Y.openEditRecipe(...e)),class:"button"}," Editer "),(0,n.bF)($,{isVisible:J.showEditRecipe,mode:"create",onClose:Y.closeEditRecipe,onCreateRecipe:Y.handleEditRecipe},null,8,["isVisible","onClose","onCreateRecipe"])]),J.showIARecipeModal?((0,n.uX)(),(0,n.Wv)(G,{key:0,onClose:Y.closeIARecipeModal,class:"modal-overlay"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",c,[t[18]||(t[18]=(0,n.Lk)("h3",{style:{"text-align":"center"}},"Personnalisez votre recette",-1)),(0,n.Lk)("div",d,[(0,n.Lk)("div",u,[(0,n.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>Y.toggleTimeDropdown&&Y.toggleTimeDropdown(...e)),class:"dropdown-btn"}," Préparation : "+(0,o.v_)(J.selectedTime||"Rapide"),1),J.showTimeDropdown?((0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(J.timeOptions,(e=>((0,n.uX)(),(0,n.CE)("li",{key:e,onClick:t=>Y.selectTime(e)},(0,o.v_)(e),9,h)))),128))])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",f,[(0,n.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>Y.toggleDifficultyDropdown&&Y.toggleDifficultyDropdown(...e)),class:"dropdown-btn"}," Difficulté : "+(0,o.v_)(J.selectedDifficulty||"Facile"),1),J.showDifficultyDropdown?((0,n.uX)(),(0,n.CE)("div",g,[(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(J.difficultyOptions,(e=>((0,n.uX)(),(0,n.CE)("li",{key:e,onClick:t=>Y.selectDifficulty(e)},(0,o.v_)(e),9,m)))),128))])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",y,[(0,n.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>Y.toggleCuisineDropdown&&Y.toggleCuisineDropdown(...e)),class:"dropdown-btn"}," Cuisine : "+(0,o.v_)(J.selectedCuisine||"Européenne"),1),J.showCuisineDropdown?((0,n.uX)(),(0,n.CE)("div",v,[(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(J.cuisineOptions,(e=>((0,n.uX)(),(0,n.CE)("li",{key:e,onClick:t=>Y.selectCuisine(e)},(0,o.v_)(e),9,w)))),128))])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",k,[(0,n.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>Y.togglePeopleDropdown&&Y.togglePeopleDropdown(...e)),class:"dropdown-btn"}," Part(s) : "+(0,o.v_)(J.selectedPeople||"1"),1),J.showPeopleDropdown?((0,n.uX)(),(0,n.CE)("div",b,[(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(J.peopleOptions,(e=>((0,n.uX)(),(0,n.CE)("li",{key:e,onClick:t=>Y.selectPeople(e)},(0,o.v_)(e),9,C)))),128))])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",M,[(0,n.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>Y.toggleTypeDropdown&&Y.toggleTypeDropdown(...e)),class:"dropdown-btn"}," Type : "+(0,o.v_)(J.selectedType||"Petit-déjeuner"),1),J.showTypeDropdown?((0,n.uX)(),(0,n.CE)("div",L,[(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(J.typeOptions,(e=>((0,n.uX)(),(0,n.CE)("li",{key:e,onClick:t=>Y.selectType(e)},(0,o.v_)(e),9,x)))),128))])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",I,[(0,n.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>Y.toggleStockOption&&Y.toggleStockOption(...e)),class:"dropdown-btn"}," Stock : "+(0,o.v_)(J.includeStock?"Oui":"Non"),1)])]),(0,n.Lk)("div",E,[(0,n.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>Y.fetchRecipe&&Y.fetchRecipe(...e)),class:"button"},"Générer"),(0,n.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>Y.closeIARecipeModal&&Y.closeIARecipeModal(...e)),class:"button"},"Fermer")])])])),_:1},8,["onClose"])):(0,n.Q3)("",!0),J.isLoading?((0,n.uX)(),(0,n.CE)("div",D,t[19]||(t[19]=[(0,n.Fv)('<div class="loading-message" data-v-3d34d05c><h2 data-v-3d34d05c>Recette en cours de création...</h2><div class="icon-slider" data-v-3d34d05c><img src="/img/gluten.png" alt="Icône 1" class="icon" data-v-3d34d05c><img src="/img/lait.png" alt="Icône 2" class="icon" data-v-3d34d05c><img src="/img/oeufs.png" alt="Icône 3" class="icon" data-v-3d34d05c><img src="/img/arachide.png" alt="Icône 4" class="icon" data-v-3d34d05c><img src="/img/noix.png" alt="Icône 5" class="icon" data-v-3d34d05c><img src="/img/poissons.png" alt="Icône 6" class="icon" data-v-3d34d05c><img src="/img/soja.png" alt="Icône 7" class="icon" data-v-3d34d05c><img src="/img/crustacés.png" alt="Icône 8" class="icon" data-v-3d34d05c><img src="/img/moutarde.png" alt="Icône 9" class="icon" data-v-3d34d05c><img src="/img/céleri.png" alt="Icône 10" class="icon" data-v-3d34d05c></div></div>',1)]))):(0,n.Q3)("",!0),J.showModal?((0,n.uX)(),(0,n.Wv)(G,{key:2,onClose:Y.closeModal,class:"modal-overlay"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",T,[(0,n.Lk)("h3",S,(0,o.v_)(J.recipe.title),1),J.recipe.image?((0,n.uX)(),(0,n.CE)("img",{key:0,src:J.recipe.image,alt:"Image de la recette",class:"modal-recipe-image"},null,8,A)):(0,n.Q3)("",!0),(0,n.Lk)("div",R,[(0,n.Lk)("div",_,[(0,n.Lk)("div",P,[t[20]||(t[20]=(0,n.Lk)("strong",null,"Préparation:",-1)),(0,n.eW)(" "+(0,o.v_)(J.recipe.time),1)]),(0,n.Lk)("div",O,[t[21]||(t[21]=(0,n.Lk)("strong",null,"Difficulté:",-1)),(0,n.eW)(" "+(0,o.v_)(J.recipe.difficulty),1)]),(0,n.Lk)("div",F,[t[22]||(t[22]=(0,n.Lk)("strong",null,"Part(s):",-1)),(0,n.eW)(" "+(0,o.v_)(J.recipe.people),1)])]),(0,n.Lk)("div",Q,[(0,n.Lk)("div",X,[t[23]||(t[23]=(0,n.Lk)("strong",null,"Cuisine:",-1)),(0,n.eW)(" "+(0,o.v_)(J.recipe.cuisine),1)]),(0,n.Lk)("div",z,[t[24]||(t[24]=(0,n.Lk)("strong",null,"Type:",-1)),(0,n.eW)(" "+(0,o.v_)(J.recipe.type),1)]),J.recipe.restrictionsList&&J.recipe.restrictionsList.length?((0,n.uX)(),(0,n.CE)("div",j,[t[25]||(t[25]=(0,n.Lk)("strong",null,"Sans allergène:",-1)),(0,n.eW)(" "+(0,o.v_)(J.recipe.restrictionsList.join(", ")),1)])):(0,n.Q3)("",!0)])]),t[26]||(t[26]=(0,n.Lk)("h4",null,"Ingrédients",-1)),(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(J.recipe.ingredients,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t},(0,o.v_)(J.recipe.quantity[t])+" "+(0,o.v_)(e),1)))),128))]),t[27]||(t[27]=(0,n.Lk)("h4",null,"Instructions",-1)),(0,n.Lk)("ol",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(J.recipe.instructions,(e=>((0,n.uX)(),(0,n.CE)("li",{key:e},(0,o.v_)(e),1)))),128))]),(0,n.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>Y.closeModal&&Y.closeModal(...e))},"Fermer")])])),_:1},8,["onClose"])):(0,n.Q3)("",!0),J.showAllergenAlert?((0,n.uX)(),(0,n.Wv)(G,{key:3,onClose:t[13]||(t[13]=e=>J.showAllergenAlert=!1),class:"modal-overlay"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",B,[t[28]||(t[28]=(0,n.Lk)("h3",{style:{"text-align":"center"}},"Aucun allergène enregistré dans votre profil",-1)),t[29]||(t[29]=(0,n.Lk)("p",{style:{"text-align":"center"}},"Souhaitez-vous continuer ou modifier votre profil ?",-1)),t[30]||(t[30]=(0,n.Lk)("p",{style:{"text-align":"center"}},"Si vous continuez la recette générée par l'IA ne prendra pas en compte vos allergènes",-1)),(0,n.Lk)("div",W,[(0,n.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>Y.proceedWithoutAllergens&&Y.proceedWithoutAllergens(...e)),class:"button"},"Continuer"),(0,n.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>Y.redirectToProfile&&Y.redirectToProfile(...e)),class:"button"},"Modifier le profil")])])])),_:1})):(0,n.Q3)("",!0),J.showStockModal?((0,n.uX)(),(0,n.Wv)(G,{key:4,onClose:Y.closeStockSelectionModal},{default:(0,n.k6)((()=>[(0,n.Lk)("div",N,[J.availableIngredients.length>0?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[t[31]||(t[31]=(0,n.Lk)("h3",null,"Sélectionnez les ingrédients à inclure",-1)),(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(J.availableIngredients,((e,i)=>((0,n.uX)(),(0,n.CE)("li",{key:i},[(0,n.Lk)("label",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",value:e.food_name,"onUpdate:modelValue":t[14]||(t[14]=e=>J.selectedIngredients=e)},null,8,V),[[a.lH,J.selectedIngredients]]),(0,n.bo)((0,n.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.selectedQuantity=t,placeholder:"Quantité en "+e.unit,max:e.maxQuantity,min:1,disabled:!J.selectedIngredients.includes(e.food_name),onInput:t=>Y.validateQuantity(e),style:{"margin-left":"10px",width:"50px"}},null,40,q),[[a.Jo,e.selectedQuantity,void 0,{number:!0}]])]),(0,n.Lk)("i",{class:"bi bi-plus-circle-fill icon-action",onClick:t=>e.selectedQuantity=Math.min(e.selectedQuantity+1,e.maxQuantity),title:"Ajouter"},null,8,U),(0,n.Lk)("i",{class:"bi bi-dash-circle-fill icon-action",onClick:t=>e.selectedQuantity=Math.max(e.selectedQuantity-1,1),title:"Diminuer"},null,8,H),(0,n.eW)(" "+(0,o.v_)(e.food_name)+" (Max: "+(0,o.v_)(e.maxQuantity)+" "+(0,o.v_)(e.unit)+") ",1)])))),128))]),(0,n.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>Y.confirmSelection&&Y.confirmSelection(...e))},"Confirmer")],64)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[t[32]||(t[32]=(0,n.Lk)("h3",null,"Votre liste d’ingrédients en stock est vide",-1)),t[33]||(t[33]=(0,n.Lk)("p",null,"Voulez-vous ajouter des ingrédients en stock ? Vous serez redirigé vers la page des ingrédients.",-1)),(0,n.Lk)("div",K,[(0,n.Lk)("button",{onClick:t[16]||(t[16]=e=>Y.handleStockModalResponse("add")),class:"button"},"Ajouter des ingrédients"),(0,n.Lk)("button",{onClick:t[17]||(t[17]=e=>Y.handleStockModalResponse("cancel")),class:"button"},"Annuler")])],64))])])),_:1},8,["onClose"])):(0,n.Q3)("",!0)]),t[36]||(t[36]=(0,n.Lk)("canvas",{id:"confetti-canvas"},null,-1))])}i(4114),i(7642),i(8004),i(3853),i(5876),i(2475),i(5024),i(1698);var J=i(8437),Y=(i(4603),i(7566),i(8721),{});(function e(t,i,n,o){var a=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),s="function"===typeof Path2D&&"function"===typeof DOMMatrix,r=function(){if(!t.OffscreenCanvas)return!1;var e=new OffscreenCanvas(1,1),i=e.getContext("2d");i.fillRect(0,0,1,1);var n=e.transferToImageBitmap();try{i.createPattern(n,"no-repeat")}catch(o){return!1}return!0}();function l(){}function c(e){var n=i.exports.Promise,o=void 0!==n?n:t.Promise;return"function"===typeof o?new o(e):(e(l,l),null)}var d,u=function(e,t){return{transform:function(i){if(e)return i;if(t.has(i))return t.get(i);var n=new OffscreenCanvas(i.width,i.height),o=n.getContext("2d");return o.drawImage(i,0,0),t.set(i,n),n},clear:function(){t.clear()}}}(r,new Map),p=function(){var e,t,i=Math.floor(1e3/60),n={},o=0;return"function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?(e=function(e){var t=Math.random();return n[t]=requestAnimationFrame((function a(s){o===s||o+i-1<s?(o=s,delete n[t],e()):n[t]=requestAnimationFrame(a)})),t},t=function(e){n[e]&&cancelAnimationFrame(n[e])}):(e=function(e){return setTimeout(e,i)},t=function(e){return clearTimeout(e)}),{frame:e,cancel:t}}(),h=function(){var t,i,o={};function s(e){function t(t,i){e.postMessage({options:t||{},callback:i})}e.init=function(t){var i=t.transferControlToOffscreen();e.postMessage({canvas:i},[i])},e.fire=function(n,a,s){if(i)return t(n,null),i;var r=Math.random().toString(36).slice(2);return i=c((function(a){function l(t){t.data.callback===r&&(delete o[r],e.removeEventListener("message",l),i=null,u.clear(),s(),a())}e.addEventListener("message",l),t(n,r),o[r]=l.bind(null,{data:{callback:r}})})),i},e.reset=function(){for(var t in e.postMessage({reset:!0}),o)o[t](),delete o[t]}}return function(){if(t)return t;if(!n&&a){var i=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{t=new Worker(URL.createObjectURL(new Blob([i])))}catch(o){return void 0!==typeof console&&"function"===typeof console.warn&&console.warn("🎊 Could not load worker",o),null}s(t)}return t}}(),f={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function g(e,t){return t?t(e):e}function m(e){return!(null===e||void 0===e)}function y(e,t,i){return g(e&&m(e[t])?e[t]:f[t],i)}function v(e){return e<0?0:Math.floor(e)}function w(e,t){return Math.floor(Math.random()*(t-e))+e}function k(e){return parseInt(e,16)}function b(e){return e.map(C)}function C(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:k(t.substring(0,2)),g:k(t.substring(2,4)),b:k(t.substring(4,6))}}function M(e){var t=y(e,"origin",Object);return t.x=y(t,"x",Number),t.y=y(t,"y",Number),t}function L(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function x(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function I(e){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=e,t}function E(e,t,i,n,o,a,s,r,l){e.save(),e.translate(t,i),e.rotate(a),e.scale(n,o),e.arc(0,0,1,s,r,l),e.restore()}function D(e){var t=e.angle*(Math.PI/180),i=e.spread*(Math.PI/180);return{x:e.x,y:e.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*e.startVelocity+Math.random()*e.startVelocity,angle2D:-t+(.5*i-Math.random()*i),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:e.color,shape:e.shape,tick:0,totalTicks:e.ticks,decay:e.decay,drift:e.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*e.gravity,ovalScalar:.6,scalar:e.scalar,flat:e.flat}}function T(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var i=t.tick++/t.totalTicks,n=t.x+t.random*t.tiltCos,o=t.y+t.random*t.tiltSin,a=t.wobbleX+t.random*t.tiltCos,r=t.wobbleY+t.random*t.tiltSin;if(e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-i)+")",e.beginPath(),s&&"path"===t.shape.type&&"string"===typeof t.shape.path&&Array.isArray(t.shape.matrix))e.fill(_(t.shape.path,t.shape.matrix,t.x,t.y,.1*Math.abs(a-n),.1*Math.abs(r-o),Math.PI/10*t.wobble));else if("bitmap"===t.shape.type){var l=Math.PI/10*t.wobble,c=.1*Math.abs(a-n),d=.1*Math.abs(r-o),p=t.shape.bitmap.width*t.scalar,h=t.shape.bitmap.height*t.scalar,f=new DOMMatrix([Math.cos(l)*c,Math.sin(l)*c,-Math.sin(l)*d,Math.cos(l)*d,t.x,t.y]);f.multiplySelf(new DOMMatrix(t.shape.matrix));var g=e.createPattern(u.transform(t.shape.bitmap),"no-repeat");g.setTransform(f),e.globalAlpha=1-i,e.fillStyle=g,e.fillRect(t.x-p/2,t.y-h/2,p,h),e.globalAlpha=1}else if("circle"===t.shape)e.ellipse?e.ellipse(t.x,t.y,Math.abs(a-n)*t.ovalScalar,Math.abs(r-o)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):E(e,t.x,t.y,Math.abs(a-n)*t.ovalScalar,Math.abs(r-o)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if("star"===t.shape){var m=Math.PI/2*3,y=4*t.scalar,v=8*t.scalar,w=t.x,k=t.y,b=5,C=Math.PI/b;while(b--)w=t.x+Math.cos(m)*v,k=t.y+Math.sin(m)*v,e.lineTo(w,k),m+=C,w=t.x+Math.cos(m)*y,k=t.y+Math.sin(m)*y,e.lineTo(w,k),m+=C}else e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(o)),e.lineTo(Math.floor(a),Math.floor(r)),e.lineTo(Math.floor(n),Math.floor(t.wobbleY));return e.closePath(),e.fill(),t.tick<t.totalTicks}function S(e,t,i,a,s){var r,l,d=t.slice(),h=e.getContext("2d"),f=c((function(t){function c(){r=l=null,h.clearRect(0,0,a.width,a.height),u.clear(),s(),t()}function f(){!n||a.width===o.width&&a.height===o.height||(a.width=e.width=o.width,a.height=e.height=o.height),a.width||a.height||(i(e),a.width=e.width,a.height=e.height),h.clearRect(0,0,a.width,a.height),d=d.filter((function(e){return T(h,e)})),d.length?r=p.frame(f):c()}r=p.frame(f),l=c}));return{addFettis:function(e){return d=d.concat(e),f},canvas:e,promise:f,reset:function(){r&&p.cancel(r),l&&l()}}}function A(e,i){var n,o=!e,s=!!y(i||{},"resize"),r=!1,l=y(i,"disableForReducedMotion",Boolean),d=a&&!!y(i||{},"useWorker"),u=d?h():null,p=o?L:x,f=!(!e||!u)&&!!e.__confetti_initialized,g="function"===typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function m(t,i,o){var a=y(t,"particleCount",v),s=y(t,"angle",Number),r=y(t,"spread",Number),l=y(t,"startVelocity",Number),c=y(t,"decay",Number),d=y(t,"gravity",Number),u=y(t,"drift",Number),h=y(t,"colors",b),f=y(t,"ticks",Number),g=y(t,"shapes"),m=y(t,"scalar"),k=!!y(t,"flat"),C=M(t),L=a,x=[],I=e.width*C.x,E=e.height*C.y;while(L--)x.push(D({x:I,y:E,angle:s,spread:r,startVelocity:l,color:h[L%h.length],shape:g[w(0,g.length)],ticks:f,decay:c,gravity:d,drift:u,scalar:m,flat:k}));return n?n.addFettis(x):(n=S(e,x,p,i,o),n.promise)}function k(i){var a=l||y(i,"disableForReducedMotion",Boolean),d=y(i,"zIndex",Number);if(a&&g)return c((function(e){e()}));o&&n?e=n.canvas:o&&!e&&(e=I(d),document.body.appendChild(e)),s&&!f&&p(e);var h={width:e.width,height:e.height};function v(){if(u){var t={getBoundingClientRect:function(){if(!o)return e.getBoundingClientRect()}};return p(t),void u.postMessage({resize:{width:t.width,height:t.height}})}h.width=h.height=null}function w(){n=null,s&&(r=!1,t.removeEventListener("resize",v)),o&&e&&(document.body.contains(e)&&document.body.removeChild(e),e=null,f=!1)}return u&&!f&&u.init(e),f=!0,u&&(e.__confetti_initialized=!0),s&&!r&&(r=!0,t.addEventListener("resize",v,!1)),u?u.fire(i,h,w):m(i,h,w)}return k.reset=function(){u&&u.reset(),n&&n.reset()},k}function R(){return d||(d=A(null,{useWorker:!0,resize:!0})),d}function _(e,t,i,n,o,a,s){var r=new Path2D(e),l=new Path2D;l.addPath(r,new DOMMatrix(t));var c=new Path2D;return c.addPath(l,new DOMMatrix([Math.cos(s)*o,Math.sin(s)*o,-Math.sin(s)*a,Math.cos(s)*a,i,n])),c}function P(e){if(!s)throw new Error("path confetti are not supported in this browser");var t,i;"string"===typeof e?t=e:(t=e.path,i=e.matrix);var n=new Path2D(t),o=document.createElement("canvas"),a=o.getContext("2d");if(!i){for(var r,l,c=1e3,d=c,u=c,p=0,h=0,f=0;f<c;f+=2)for(var g=0;g<c;g+=2)a.isPointInPath(n,f,g,"nonzero")&&(d=Math.min(d,f),u=Math.min(u,g),p=Math.max(p,f),h=Math.max(h,g));r=p-d,l=h-u;var m=10,y=Math.min(m/r,m/l);i=[y,0,0,y,-Math.round(r/2+d)*y,-Math.round(l/2+u)*y]}return{type:"path",path:t,matrix:i}}function O(e){var t,i=1,n="#000000",o='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"===typeof e?t=e:(t=e.text,i="scalar"in e?e.scalar:i,o="fontFamily"in e?e.fontFamily:o,n="color"in e?e.color:n);var a=10*i,s=a+"px "+o,r=new OffscreenCanvas(a,a),l=r.getContext("2d");l.font=s;var c=l.measureText(t),d=Math.ceil(c.actualBoundingBoxRight+c.actualBoundingBoxLeft),u=Math.ceil(c.actualBoundingBoxAscent+c.actualBoundingBoxDescent),p=2,h=c.actualBoundingBoxLeft+p,f=c.actualBoundingBoxAscent+p;d+=p+p,u+=p+p,r=new OffscreenCanvas(d,u),l=r.getContext("2d"),l.font=s,l.fillStyle=n,l.fillText(t,h,f);var g=1/i;return{type:"bitmap",bitmap:r.transferToImageBitmap(),matrix:[g,0,0,g,-d*g/2,-u*g/2]}}i.exports=function(){return R().apply(this,arguments)},i.exports.reset=function(){R().reset()},i.exports.create=A,i.exports.shapeFromPath=P,i.exports.shapeFromText=O})(function(){return"undefined"!==typeof window?window:"undefined"!==typeof self?self:this||{}}(),Y,!1);var $=Y.exports,G=(Y.exports.create,i(4373)),ee={name:"RecipePage",components:{EditRecipe:J.A},data(){return{recipe:null,isLoading:!1,showModal:!1,showAllergenAlert:!1,showTimeDropdown:!1,showDifficultyDropdown:!1,showCuisineDropdown:!1,showPeopleDropdown:!1,showTypeDropdown:!1,includeStock:!1,showStockModal:!1,showEditRecipe:!1,isSaving:!1,isSaved:!1,selectedTime:"Rapide",selectedDifficulty:"Facile",selectedCuisine:"Européenne",selectedPeople:"1",selectedType:"Petit-déjeuner",timeOptions:["Rapide","Moyen","Long"],difficultyOptions:["Facile","Intermédiaire","Complexe"],cuisineOptions:["Européenne","Asiatique","Américaine","Africaine","Méditerranéenne","Indienne","Moyen-Orientale","Mexicaine","Caribéenne","Italienne","Chinoise","Japonaise","Thaïlandaise","Coréenne","Vietnamienne","Espagnole","Grecque","Française","Allemande","Nordique","Brésilienne","Argentine","Turque","Marocaine","Éthiopienne"],peopleOptions:["1","2","3","4","5","6","7","8"],typeOptions:["Petit-déjeuner","Lunch","Dîner","Dessert"],time:"",difficulty:"",cuisine:"",people:"",type:"",public:!0,availableIngredients:[],selectedIngredients:[],showIARecipeModal:!1}},mounted(){this.fetchAvailableIngredients()},methods:{errorHandler(e,t){0},triggerConfetti(){const e=document.getElementById("confetti-canvas"),t=$.create(e,{resize:!0});t({particleCount:150,spread:70,origin:{y:.6}})},openEditRecipe(){this.showEditRecipe=!0},closeEditRecipe(){this.showEditRecipe=!1},openIARecipeModal(){this.showIARecipeModal=!0},closeIARecipeModal(){this.showIARecipeModal=!1},validateQuantity(e){e.selectedQuantity>e.maxQuantity?e.selectedQuantity=e.maxQuantity:e.selectedQuantity<1&&(e.selectedQuantity=1)},confirmSelection(){this.selectedIngredientsWithQuantities=this.availableIngredients.filter((e=>this.selectedIngredients.includes(e.food_name))).map((e=>({food_name:e.food_name,selectedQuantity:e.selectedQuantity,unit:e.unit||"unité"}))),this.selectedIngredientsWithQuantities.some((e=>e.selectedQuantity<=0))?alert("Veuillez spécifier une quantité valide pour chaque ingrédient sélectionné."):(this.includeStock=!0,this.showStockModal=!1)},async handleEditRecipe(e){try{const t=new FormData;t.append("title",e.recipe_name),t.append("time",e.preparation_time),t.append("difficulty",e.difficulty),t.append("people",e.number_of_person),t.append("cuisine",e.cuisine_type),t.append("type",e.category_type),t.append("public",e.public),t.append("ingredients",JSON.stringify(e.ingredients)),t.append("instructions",JSON.stringify(e.instructions)),t.append("restrictionsList",JSON.stringify(e.allergens_list)),t.append("created_by_ai",!1),e.image&&t.append("image",e.image),await G.A.post("https://www.cookaller.com/recipes/save",t,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}),alert("Recette créée avec succès.")}catch(t){this.errorHandler(t,"Erreur lors de l'enregistrement de la recette"),alert("Une erreur est survenue lors de l'enregistrement de la recette. Veuillez recommencer")}},async getUserRestrictions(){try{const e=await G.A.get("https://www.cookaller.com/users/restrictions",{withCredentials:!0});return e.data.restrictions||[]}catch(e){return this.errorHandler(e,"Erreur lors de la récupération des restrictions alimentaires :"),[]}},async fetchAvailableIngredients(){try{const e=await G.A.get("https://www.cookaller.com/users/fridge",{withCredentials:!0});Array.isArray(e.data)?this.availableIngredients=e.data.map((e=>{const t=e.quantity.match(/^(\d+\.?\d*)\s*(.*)?$/);return{...e,maxQuantity:t?parseFloat(t[1]):0,unit:t&&t[2]?t[2].trim():"",selectedQuantity:1}})):this.errorHandler(null,"Les données reçues ne sont pas valides")}catch(e){this.errorHandler(e,"Erreur lors de la récupération des ingrédients en stock")}},toggleStockOption(){this.availableIngredients.length,this.showStockModal=!0},closeStockSelectionModal(){this.showStockModal=!1},handleStockModalResponse(e){"add"===e?this.$router.push("/ingredients"):"cancel"===e&&(this.includeStock=!1),this.showStockModal=!1},async fetchRecipe(){try{const e=await this.getUserRestrictions();e&&0!==e.length?this.executeRecipeLogic():this.showAllergenAlert=!0}catch(e){this.errorHandler(e,"Erreur lors de la génération de la recette"),e.response&&401===e.response.status?(alert("Votre session a expiré. Veuillez vous reconnecter."),this.$router.push("/login")):alert("Une erreur est survenue. Veuillez réessayer plus tard.")}},async executeRecipeLogic(){this.closeIARecipeModal(),this.isLoading=!0;try{const e={time:this.selectedTime,difficulty:this.selectedDifficulty,cuisine:this.selectedCuisine,people:this.selectedPeople,type:this.selectedType,availableIngredients:this.includeStock?this.selectedIngredientsWithQuantities:[]},t=await G.A.post("https://www.cookaller.com/openai/recipe",e,{headers:{"Content-Type":"application/json"},withCredentials:!0});if(!(t.data&&t.data.title&&t.data.ingredients&&t.data.instructions))throw new Error("Les données de la recette sont manquantes ou mal formatées.");{const e=[...new Set(t.data.restrictionsList)];this.recipe={title:t.data.title,ingredients:t.data.ingredients,instructions:t.data.instructions,quantity:t.data.quantity,time:t.data.time,difficulty:t.data.difficulty,cuisine:t.data.cuisine,people:t.data.people,type:t.data.type,image:t.data.image,restrictionsList:e,created_by_ai:t.data.created_by_ai,public:!0},await this.saveRecipe(),this.showModal=!0,this.triggerConfetti()}}catch(e){this.errorHandler(e,"Erreur lors de la recherche de la recette :"),alert("Une erreur est survenue lors de la recherche de la recette. Veuillez réessayer plus tard.")}finally{this.isLoading=!1}},async saveRecipe(){if(!this.isSaving&&!this.isSaved){this.isSaving=!0;try{const e={recipe:{...this.recipe,restrictionsList:this.recipe.restrictionsList||[],public:this.recipe.public},ingredients:this.recipe.ingredients.map((e=>({food_id:e.food_id,quantity:e.quantity})))};await G.A.post("https://www.cookaller.com/recipes/save",e,{headers:{"Content-Type":"application/json"}}),this.isSaved=!0}catch(e){this.errorHandler(e,"Erreur lors de l'enregistrement de la recette"),alert("Une erreur est survenue lors de l'enregistrement de la recette.")}finally{this.isSaving=!1}}},updateIngredientsList(e){this.availableIngredients=e},openModal(){this.showModal=!0},closeModal(){this.showModal=!1},toggleTimeDropdown(){this.showTimeDropdown=!this.showTimeDropdown},selectTime(e){this.selectedTime=e,this.showTimeDropdown=!1},toggleDifficultyDropdown(){this.showDifficultyDropdown=!this.showDifficultyDropdown},selectDifficulty(e){this.selectedDifficulty=e,this.showDifficultyDropdown=!1},toggleCuisineDropdown(){this.showCuisineDropdown=!this.showCuisineDropdown},selectCuisine(e){this.selectedCuisine=e,this.showCuisineDropdown=!1},togglePeopleDropdown(){this.showPeopleDropdown=!this.showPeopleDropdown},selectPeople(e){this.selectedPeople=e,this.showPeopleDropdown=!1},toggleTypeDropdown(){this.showTypeDropdown=!this.showTypeDropdown},selectType(e){this.selectedType=e,this.showTypeDropdown=!1},proceedWithoutAllergens(){this.showAllergenAlert=!1,this.executeRecipeLogic()},redirectToProfile(){this.showAllergenAlert=!1,this.$router.push("/profile")}}},te=i(1241);const ie=(0,te.A)(ee,[["render",Z],["__scopeId","data-v-3d34d05c"]]);var ne=ie}}]);
//# sourceMappingURL=166.98c998c2.js.map