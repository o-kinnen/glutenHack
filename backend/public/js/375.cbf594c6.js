"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[375],{7375:function(t,e,i){i.r(e),i.d(e,{default:function(){return z}});var s=i(6768),o=i(4232),a=i(5130);const n={class:"container"},l={class:"card p-4 text-white"},r={key:0,class:"empty-message"},c={key:1,class:"empty-message"},u={key:2},d={class:"action-buttons"},p={key:3},m={class:"category-title"},g=["src","alt"],h={class:"grocery-list"},y={class:"grocery-details"},k={class:"food-name"},f={key:0,class:"food-name"},C={class:"grocery-actions"},b={key:0,class:"update-section"},L=["onUpdate:modelValue"],v={class:"modal-actions-icons"},I=["onClick"],_=["onClick"],E=["onClick"],q={key:1},w={class:"modal-actions-icons"},x=["onClick"],V={key:4,class:"grocery-list"},X={class:"grocery-details"},Q={class:"food-name"},S={key:0,class:"food-name"},A={class:"grocery-actions"},N={key:0,class:"update-section"},F=["onUpdate:modelValue"],U={class:"modal-actions-icons"},j=["onClick"],M=["onClick"],O=["onClick"],P={key:1},R={class:"modal-actions-icons"},$=["onClick"];function B(t,e,i,B,D,T){return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("div",l,[e[10]||(e[10]=(0,s.Lk)("h1",{class:"text-white"},"Ma liste des courses",-1)),D.errorMessage?((0,s.uX)(),(0,s.CE)("div",r,(0,o.v_)(D.errorMessage),1)):0===D.shoppingItems.length?((0,s.uX)(),(0,s.CE)("div",c," La liste est vide... ")):((0,s.uX)(),(0,s.CE)("div",u,[(0,s.Lk)("div",d,[(0,s.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>T.toggleSort&&T.toggleSort(...t)),class:"button sort-btn"},(0,o.v_)((D.categoriesVisible,"Trier")),1),(0,s.Lk)("button",{onClick:e[1]||(e[1]=(...t)=>T.exportToFile&&T.exportToFile(...t)),class:"button export-btn"},"Exporter")])])),D.categoriesVisible?((0,s.uX)(),(0,s.CE)("div",p,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(D.groupedItems,((t,i)=>((0,s.uX)(),(0,s.CE)("div",{key:i,class:"category-section"},[(0,s.Lk)("h2",m,[(0,s.Lk)("img",{src:T.getCategoryIcon(i),alt:i,class:"category-icon"},null,8,g),(0,s.eW)((0,o.v_)(i),1)]),(0,s.Lk)("ul",h,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t,((t,i)=>((0,s.uX)(),(0,s.CE)("li",{key:i,class:"grocery-item"},[(0,s.Lk)("div",y,[(0,s.Lk)("span",k,(0,o.v_)(t.food_name),1),T.isValidQuantity(t.quantity)?((0,s.uX)(),(0,s.CE)("span",f,"("+(0,o.v_)(t.quantity)+")",1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",C,[T.isQuantityNumeric(t.quantity)?((0,s.uX)(),(0,s.CE)("div",b,[(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":e=>D.quantities[t.food_id]=e,placeholder:"Nouvelle quantité",class:"quantity-input"},null,8,L),[[a.Jo,D.quantities[t.food_id],void 0,{number:!0}]]),(0,s.Lk)("div",v,[(0,s.Lk)("i",{class:"bi bi-plus-circle-fill icon-action",onClick:e=>T.updateQuantity(t.food_id,"add"),title:"Ajouter"},null,8,I),e[2]||(e[2]=(0,s.Lk)("span",{class:"tooltip-text"},"Ajouter",-1)),(0,s.Lk)("i",{class:"bi bi-dash-circle-fill icon-action",onClick:e=>T.updateQuantity(t.food_id,"subtract"),title:"Diminuer"},null,8,_),e[3]||(e[3]=(0,s.Lk)("span",{class:"tooltip-text"},"Diminuer",-1)),(0,s.Lk)("i",{class:"bi bi-trash-fill icon-action",onClick:e=>T.deleteItem(t.food_name),title:"Supprimer"},null,8,E),e[4]||(e[4]=(0,s.Lk)("span",{class:"tooltip-text"},"Supprimer",-1))])])):((0,s.uX)(),(0,s.CE)("div",q,[(0,s.Lk)("div",w,[(0,s.Lk)("i",{class:"bi bi-trash-fill icon-action",onClick:e=>T.deleteItem(t.food_name),title:"Supprimer"},null,8,x),e[5]||(e[5]=(0,s.Lk)("span",{class:"tooltip-text"},"Supprimer",-1))])]))])])))),128))])])))),128))])):((0,s.uX)(),(0,s.CE)("ul",V,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(D.shoppingItems,((t,i)=>((0,s.uX)(),(0,s.CE)("li",{key:i,class:"grocery-item"},[(0,s.Lk)("div",X,[(0,s.Lk)("span",Q,(0,o.v_)(t.food_name),1),T.isValidQuantity(t.quantity)?((0,s.uX)(),(0,s.CE)("span",S,"("+(0,o.v_)(t.quantity)+")",1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",A,[T.isQuantityNumeric(t.quantity)?((0,s.uX)(),(0,s.CE)("div",N,[T.isQuantityNumeric(t.quantity)?(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",{key:0,type:"number","onUpdate:modelValue":e=>D.quantities[t.food_id]=e,placeholder:"Nouvelle quantité",class:"quantity-input"},null,8,F)),[[a.Jo,D.quantities[t.food_id],void 0,{number:!0}]]):(0,s.Q3)("",!0),(0,s.Lk)("div",U,[(0,s.Lk)("i",{class:"bi bi-plus-circle-fill icon-action",onClick:e=>T.updateQuantity(t.food_id,"add"),title:"Ajouter"},null,8,j),e[6]||(e[6]=(0,s.Lk)("span",{class:"tooltip-text"},"Ajouter",-1)),(0,s.Lk)("i",{class:"bi bi-dash-circle-fill icon-action",onClick:e=>T.updateQuantity(t.food_id,"subtract"),title:"Diminuer"},null,8,M),e[7]||(e[7]=(0,s.Lk)("span",{class:"tooltip-text"},"Diminuer",-1)),(0,s.Lk)("i",{class:"bi bi-trash-fill icon-action",onClick:e=>T.deleteItem(t.food_name),title:"Supprimer"},null,8,O),e[8]||(e[8]=(0,s.Lk)("span",{class:"tooltip-text"},"Supprimer",-1))])])):((0,s.uX)(),(0,s.CE)("div",P,[(0,s.Lk)("div",R,[(0,s.Lk)("i",{class:"bi bi-trash-fill icon-action",onClick:e=>T.deleteItem(t.food_name),title:"Supprimer"},null,8,$),e[9]||(e[9]=(0,s.Lk)("span",{class:"tooltip-text"},"Supprimer",-1))])]))])])))),128))]))])])}i(4114),i(4603),i(7566),i(8721);var D=i(4373),T={name:"GroceryPage",data(){return{shoppingItems:[],quantities:{},groupedItems:{},categoriesVisible:!1,errorMessage:""}},methods:{handleError(t){this.errorMessage="Rien pour le moment"},getCategoryIcon(t){const e={"Produits laitiers":"/img/lait.png",Noix:"/img/fruits à coque.png",Fruits:"/img/fruits.png","Légumes":"/img/céleri.png",Viande:"/img/viande.png","Féculents":"/img/gluten.png","Épices":"/img/épices.png",Poissons:"/img/poissons.png","Crustacés":"/img/crustacés.png",Sauces:"/img/moutarde.png"};return e[t]||"/img/shopping.png"},groupItemsByCategory(){const t=["Produits laitiers","Noix","Fruits","Légumes","Viande","Féculents","Épices","Poissons","Crustacés","Sauces"];this.groupedItems={},this.shoppingItems.forEach((t=>{const e=t.category?t.category.charAt(0).toUpperCase()+t.category.slice(1):"Autres";this.groupedItems[e]||(this.groupedItems[e]=[]),this.groupedItems[e].push(t)})),this.groupedItems=Object.keys(this.groupedItems).sort(((e,i)=>t.indexOf(e)-t.indexOf(i))).reduce(((t,e)=>(t[e]=this.groupedItems[e],t)),{})},toggleSort(){this.categoriesVisible?this.categoriesVisible=!1:(this.groupItemsByCategory(),this.categoriesVisible=!0)},isValidQuantity(t){return t&&"string"===typeof t&&!isNaN(parseFloat(t))&&"N/A"!==t.toUpperCase()},async fetchShoppingList(){try{const t=await D.A.get("https://www.cookaller.com/shopping-list/",{withCredentials:!0});this.listId=t.data.listId,this.shoppingItems=t.data.items,this.shoppingItems.forEach((t=>{if(t.category=t.category?t.category:"Autres",this.isQuantityNumeric(t.quantity)){const e=t.quantity.match(/^(\d+)/);this.quantities[t.food_id]=e?parseInt(e[1],10):0}}))}catch(t){this.handleError(t)}},exportToFile(){let t="Ma liste des courses\n\n";this.categoriesVisible?Object.keys(this.groupedItems).forEach((e=>{t+=`${e}\n`,this.groupedItems[e].forEach((e=>{t+=`- ${e.food_name} (${e.quantity})\n`})),t+="\n"})):this.shoppingItems.forEach((e=>{t+=`- ${e.food_name} (${e.quantity})\n`}));const e=new Blob([t],{type:"text/plain"}),i=document.createElement("a");i.href=URL.createObjectURL(e),i.download="Ma_liste_des_courses.txt",i.click(),URL.revokeObjectURL(i.href)},async deleteItem(t){try{await D.A.delete("https://www.cookaller.com/shopping-list/delete",{params:{food_name:t},withCredentials:!0}),this.shoppingItems=this.shoppingItems.filter((e=>e.food_name!==t)),this.categoriesVisible&&this.groupItemsByCategory()}catch(e){this.handleError(e)}},async updateQuantity(t,e="add"){const i=this.quantities[t];if(void 0===i||i<=0)return void alert("Veuillez entrer une quantité valide.");const s="add"===e?i:-i;try{const i=this.shoppingItems.find((e=>e.food_id===t));if(i){const t=parseInt(i.quantity.match(/^(\d+)/)[1],10);if("subtract"===e&&t+s<=0)return void alert("La quantité ne peut pas être égale à 0.")}const o=await D.A.post("https://www.cookaller.com/shopping-list/update-quantity",{listId:this.listId,foodId:t,incrementValue:s},{withCredentials:!0});i&&(i.quantity=o.data.newQuantity)}catch(o){this.handleError(o)}},isQuantityNumeric(t){return/^\d+/.test(t)}},mounted(){this.fetchShoppingList()}},K=i(1241);const J=(0,K.A)(T,[["render",B],["__scopeId","data-v-4d4a2220"]]);var z=J}}]);
//# sourceMappingURL=375.cbf594c6.js.map