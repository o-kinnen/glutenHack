{"version":3,"file":"js/407.970952f5.js","mappings":"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","sources":["webpack://frontend/./src/views/ProfilePage.vue","webpack://frontend/./src/views/ProfilePage.vue?ccbe"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"card p-4 text-white\">\r\n      <h2>Bienvenue {{ username }} !</h2>\r\n      <p>Mon adresse mail : <strong>{{ email }}</strong></p>\r\n      <p>Mes allergènes :</p>\r\n      <div v-if=\"selectedRestrictions.length\" class=\"allergens-grid\">\r\n        <div v-for=\"(restriction, index) in selectedRestrictions\" :key=\"index\" class=\"allergen-item\">\r\n          <img :src=\"`/img/${restriction.toLowerCase()}.png`\" alt=\"Icone\" class=\"restriction-icon\" />\r\n          <span><strong>{{ restriction }}</strong></span>\r\n        </div>\r\n      </div>\r\n      <p v-else><strong>Aucun</strong></p>\r\n      <div v-if=\"errorMessage\" class=\"error-alert\">\r\n        {{ errorMessage }}\r\n      </div>\r\n      <div class=\"mt-4\">\r\n        <button class=\"button btn mb-2\" @click=\"modifyProfile\">Modifier mes allergènes</button><br>\r\n        <button class=\"button btn mb-2\" @click=\"logout\">Se déconnecter</button><br>\r\n        <button class=\"button btn\" @click=\"deleteAccount\">Supprimer le compte</button>\r\n      </div>\r\n    </div>\r\n    <div v-if=\"showModal\" class=\"modal-overlay\">\r\n      <div class=\"modal-content\">\r\n        <h2>Mes allergènes</h2>\r\n        <form @submit.prevent=\"submitForm\">\r\n          <div class=\"checkbox-group\">\r\n            <label v-for=\"restriction in restrictions\" :key=\"restriction.name\">\r\n              <input type=\"checkbox\" v-model=\"restriction.selected\"/>\r\n              <span class=\"text-and-icon\">\r\n                <img :src=\"`/img/${restriction.name.toLowerCase()}.png`\" alt=\"Icone\" class=\"restriction-icon\" />\r\n                  {{ restriction.name }}\r\n              </span>\r\n            </label>\r\n          </div>\r\n          <button type=\"submit\" class=\"button btn me-3\">Confirmer</button>\r\n          <button type=\"button\" class=\"button btn\" @click=\"showModal = false\">Fermer</button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n  \r\n<script>\r\nexport default {\r\n  name: 'ProfilePage',\r\n  data() {\r\n    return {\r\n      username: '',\r\n      email: '',\r\n      userId: null,\r\n      showModal: false,\r\n      errorMessage: '',\r\n      restrictions: [\r\n        { name: \"Gluten\", selected: false },\r\n        { name: \"Lait\", selected: false},\r\n        { name: \"Oeufs\", selected: false },\r\n        { name: \"Arachide\", selected: false },\r\n        { name: \"Noix\", selected: false },\r\n        { name: \"Poissons\", selected: false },\r\n        { name: \"Soja\", selected: false },\r\n        { name: \"Crustacés\", selected: false },\r\n        { name: \"Moutarde\", selected: false },\r\n        { name: \"Céleri\", selected: false }\r\n      ]\r\n    }\r\n  },\r\n  computed: {\r\n    selectedRestrictions() {\r\n      return this.restrictions.filter(item => item.selected).map(item => item.name);\r\n    },\r\n    selectedRestrictionsText() {\r\n      return this.selectedRestrictions.length ? this.selectedRestrictions.join(\", \") : \"Aucun\";\r\n    }\r\n  },\r\n  methods: {\r\n    async fetchProfile() {\r\n      try {\r\n        const response = await fetch(`${process.env.VUE_APP_URL_BACKEND}/users/profile`, {\r\n          credentials: 'include',\r\n        });\r\n        const data = await response.json();\r\n        if (response.ok) {\r\n          this.username = data.username;\r\n          this.email = data.email;\r\n          this.userId = data.user_id;\r\n          this.updatePreferencesFromProfile(data.restrictions);\r\n        } else {\r\n          this.errorMessage = data.message || 'Erreur lors de la récupération des informations du profil.';\r\n          this.$router.push('/login');\r\n        }\r\n      } catch (error) {\r\n        this.handleError('Erreur lors de la communication avec le serveur. Veuillez réessayer plus tard.', error);\r\n      }\r\n    },\r\n    updatePreferencesFromProfile(restrictions) {\r\n      this.restrictions.forEach(restriction => {\r\n        restriction.selected = restrictions.includes(restriction.name);\r\n      });\r\n    },\r\n    modifyProfile() {\r\n      this.showModal = true;\r\n    },\r\n    async submitForm() {\r\n      const selectedRestrictions = this.restrictions.filter(item => item.selected).map(item => item.name);\r\n      try {\r\n        const response = await fetch(`${process.env.VUE_APP_URL_BACKEND}/users/update-preferences/${this.userId}`, {\r\n          method: 'PUT',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ restrictions: selectedRestrictions}),\r\n          credentials: 'include',\r\n        });\r\n        if (response.ok) {\r\n          this.showModal = false;\r\n          await this.fetchProfile();\r\n        } else {\r\n          this.handleError('Erreur lors de la mise à jour des préférences.');\r\n        }\r\n      } catch (error) {\r\n        this.handleError('Erreur:', error);\r\n      }\r\n    },\r\n    async logout() {\r\n      try {\r\n        const response = await fetch(`${process.env.VUE_APP_URL_BACKEND}/users/logout`, {\r\n          method: 'POST',\r\n          credentials: 'include',\r\n        });\r\n        if (response.ok) {\r\n          this.$store.dispatch('logout');\r\n          this.$router.push('/login');\r\n        } else {\r\n          this.handleError('Erreur lors de la déconnexion. Veuillez réessayer.');\r\n        }\r\n      } catch (error) {\r\n        this.handleError('Erreur lors de la communication avec le serveur. Veuillez réessayer plus tard.', error);\r\n      }\r\n    },\r\n    async deleteAccount() {\r\n      if (confirm('Êtes-vous sûr de vouloir supprimer votre compte ? Cette action est irréversible')) {\r\n        try {\r\n          const response = await fetch(`${process.env.VUE_APP_URL_BACKEND}/users/delete`, {\r\n            method: 'DELETE',\r\n            credentials: 'include',\r\n          });\r\n          if (response.ok) {\r\n            alert('Votre compte a été supprimé avec succès.');\r\n            this.$store.dispatch('logout');\r\n            this.$router.push('/');\r\n          } else {\r\n            this.handleError('Erreur lors de la suppression du compte. Veuillez réessayer.');\r\n          }\r\n        } catch (error) {\r\n          this.handleError('Erreur lors de la communication avec le serveur. Veuillez réessayer plus tard.', error);\r\n        }\r\n      }\r\n    },\r\n    handleError(userMessage, error = null) {\r\n      this.errorMessage = userMessage;\r\n      if (process.env.NODE_ENV !== 'production' && error) {\r\n        console.error('Erreur:', error);\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchProfile();\r\n  },\r\n};\r\n</script>\r\n  \r\n<style scoped>\r\n.card {\r\n  background-color: #212121;\r\n  border: none;\r\n  border-radius: 8px;\r\n  width: 90%;\r\n  max-width: 400px;\r\n  padding: 20px;\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n}\r\nbutton {\r\n  background-color: #BA9371;\r\n  color: white;\r\n  border: none;\r\n  transition: all 0.3s ease;\r\n}\r\nbutton:hover {\r\n  background-color: #C56929;\r\n  transform: scale(1.05);\r\n  color: white;\r\n}\r\n.container {\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 9999;\r\n}\r\n.modal-content {\r\n  background-color: #212121;\r\n  color: #fff;\r\n  padding: 20px;\r\n  border-radius: 12px;\r\n  max-width: 400px;\r\n  width: 100%;\r\n  animation: fadeIn 0.3s ease-out;\r\n}\r\n.checkbox-group {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 15px;\r\n  margin-bottom: 20px;\r\n}\r\n.checkbox-group label {\r\n  display: flex;\r\n  font-size: 18px;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\ninput[type=\"checkbox\"] {\r\n  appearance: none;\r\n  width: 20px;\r\n  height: 20px;\r\n  border: 2px solid white;\r\n  border-radius: 4px;\r\n  background-color: #fff;\r\n  cursor: pointer;\r\n  position: relative;\r\n}\r\ninput[type=\"checkbox\"]:checked {\r\n  background-color: #C56929;\r\n  border-color: #C56929;\r\n}\r\ninput[type=\"checkbox\"]:checked::after {\r\n  content: \"✓\";\r\n  color: #ffffff;\r\n  font-size: 16px;\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n}\r\n.text-and-icon {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  width: 100%;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n.restriction-icon {\r\n  width: 24px;\r\n  height: 24px;\r\n  object-fit: contain;\r\n  transition: all 0.3s ease;\r\n}\r\n.restriction-icon:hover {\r\n  transform: scale(1.2);\r\n  opacity: 0.8;\r\n}\r\n.checkbox-group input[type=\"checkbox\"] {\r\n  margin-left: 10px;\r\n}\r\n.allergens-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 16px;\r\n  justify-items: center;\r\n  align-items: center;\r\n}\r\n.allergen-item {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  text-align: center;\r\n}\r\n.error-alert {\r\n  color: red;\r\n  background-color: #fdd;\r\n  padding: 10px;\r\n  margin-top: 10px;\r\n  border-radius: 4px;\r\n  text-align: center;\r\n}\r\n@keyframes fadeIn {\r\n  from {\r\n    opacity: 0;\r\n    transform: scale(0.9);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: scale(1);\r\n  }\r\n}\r\n</style>\r\n  ","import { render } from \"./ProfilePage.vue?vue&type=template&id=113e99d2&scoped=true\"\nimport script from \"./ProfilePage.vue?vue&type=script&lang=js\"\nexport * from \"./ProfilePage.vue?vue&type=script&lang=js\"\n\nimport \"./ProfilePage.vue?vue&type=style&index=0&id=113e99d2&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-113e99d2\"]])\n\nexport default __exports__"],"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_toDisplayString","$data","username","_createTextVNode","email","$options","selectedRestrictions","length","_hoisted_3","_Fragment","_renderList","restriction","index","src","toLowerCase","alt","_hoisted_4","_hoisted_5","_cache","errorMessage","_hoisted_6","_createCommentVNode","_hoisted_7","onClick","args","modifyProfile","logout","deleteAccount","showModal","_hoisted_8","_hoisted_9","onSubmit","_withModifiers","submitForm","_hoisted_10","restrictions","name","type","$event","selected","_hoisted_11","_hoisted_12","_hoisted_13","data","userId","computed","this","filter","item","map","selectedRestrictionsText","join","methods","fetchProfile","response","fetch","credentials","json","ok","user_id","updatePreferencesFromProfile","message","$router","push","error","handleError","forEach","includes","method","headers","body","JSON","stringify","$store","dispatch","confirm","alert","userMessage","created","__exports__","render"],"sourceRoot":""}