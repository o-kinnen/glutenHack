{"version":3,"file":"js/888.cd8080c3.js","mappings":"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","sources":["webpack://frontend/./src/views/AnalysePage.vue","webpack://frontend/./src/views/AnalysePage.vue?2c55"],"sourcesContent":["<template>\r\n  <div>\r\n    <h1>Mes analyses</h1>\r\n    <p>Recherchez un aliment en scannant ou en entrant son code-barre pour savoir s'il est sûr pour vous.</p>\r\n\r\n    <div>\r\n      <label for=\"codeBarreInput\">Entrez un code-barre :</label>\r\n      <input \r\n        type=\"text\" \r\n        id=\"codeBarreInput\" \r\n        v-model=\"codeBarre\" \r\n        placeholder=\"Entrez un code-barre\" \r\n      />\r\n      <button @click=\"verifierAliment\">Vérifier</button>\r\n    </div>\r\n\r\n    <div v-if=\"resultat !== null\" class=\"resultat\">\r\n      <p><strong>Nom de l'aliment :</strong> {{ resultat.nomAliment }}</p>\r\n\r\n      <div v-if=\"resultat.imageUrl\">\r\n        <p><strong>Photo de l'aliment :</strong></p>\r\n        <img :src=\"resultat.imageUrl\" alt=\"Photo de l'aliment\" style=\"max-width: 200px; border: 1px solid #ccc;\" />\r\n      </div>\r\n\r\n      <p v-if=\"!resultat.peutManger\">\r\n        ⚠️ Cet aliment contient des allergènes problématiques pour vous : {{ resultat.allergenesProbleme.join(', ') }}\r\n      </p>\r\n      <p v-else>\r\n        ✅ Cet aliment est sûr pour vous. Aucun allergène problématique détecté.\r\n      </p>\r\n\r\n      <p class=\"source\">\r\n        <small>{{ resultat.source }}</small>\r\n      </p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  name: \"AnalysePage\",\r\n  data() {\r\n    return {\r\n      codeBarre: \"\",\r\n      resultat: null, \r\n    };\r\n  },\r\n  methods: {\r\n    async getUserRestrictions() {\r\n      try {\r\n        const response = await axios.get(`${process.env.VUE_APP_URL_BACKEND}/users/restrictions`, {\r\n          withCredentials: true,\r\n        });\r\n        return (response.data.restrictions || []).map(restriction => restriction.toLowerCase());\r\n      } catch (error) {\r\n        console.error('Erreur lors de la récupération des restrictions alimentaires :', error);\r\n        alert('Impossible de récupérer les restrictions alimentaires. Veuillez réessayer.');\r\n        return [];\r\n      }\r\n    },\r\n\r\n    async verifierAliment() {\r\n      const codeBarre = this.codeBarre ? this.codeBarre.trim() : \"\";\r\n\r\n      if (!codeBarre) {\r\n        alert(\"Veuillez entrer un code-barre.\");\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await axios.get(`${process.env.VUE_APP_URL_BACKEND}/api/food`, { params: { codeBarre } });\r\n        const allergenesAliment = response.data.allergenes || [];\r\n        const nomAliment = response.data.barcode_name || \"Nom inconnu\";\r\n        const imageUrl = response.data.imageUrl || \"\";\r\n        const source = response.data.source || \"\";\r\n\r\n        const restrictionsUtilisateur = await this.getUserRestrictions();\r\n\r\n        const allergenesProbleme = allergenesAliment.filter(allergene =>\r\n          restrictionsUtilisateur.includes(allergene.toLowerCase())\r\n        );\r\n\r\n        this.resultat = {\r\n          nomAliment, \r\n          imageUrl, \r\n          allergenes: allergenesAliment,\r\n          peutManger: allergenesProbleme.length === 0,\r\n          allergenesProbleme,\r\n          source,\r\n        };\r\n      } catch (error) {\r\n        console.error(\"Erreur lors de la vérification de l'aliment :\", error);\r\n        alert(\"Une erreur est survenue lors de la vérification. Veuillez réessayer.\");\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.resultat {\r\n  margin-top: 20px;\r\n  font-size: 1.2em;\r\n}\r\nimg {\r\n  display: block;\r\n  margin: 10px 0;\r\n}\r\n.source {\r\n  margin-top: 20px;\r\n  font-size: 0.9em;\r\n  color: #666;\r\n}\r\n</style>\r\n","import { render } from \"./AnalysePage.vue?vue&type=template&id=1333589f&scoped=true\"\nimport script from \"./AnalysePage.vue?vue&type=script&lang=js\"\nexport * from \"./AnalysePage.vue?vue&type=script&lang=js\"\n\nimport \"./AnalysePage.vue?vue&type=style&index=0&id=1333589f&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1333589f\"]])\n\nexport default __exports__"],"names":["key","class","_createElementBlock","_createElementVNode","for","type","id","_cache","$event","$data","codeBarre","placeholder","onClick","args","$options","verifierAliment","resultat","_hoisted_1","_createTextVNode","_toDisplayString","nomAliment","imageUrl","_hoisted_2","src","alt","style","_hoisted_3","_createCommentVNode","peutManger","_hoisted_5","_hoisted_4","allergenesProbleme","join","_hoisted_6","source","name","data","methods","getUserRestrictions","response","axios","get","withCredentials","restrictions","map","restriction","toLowerCase","error","console","alert","this","trim","params","allergenesAliment","allergenes","barcode_name","restrictionsUtilisateur","filter","allergene","includes","length","__exports__","render"],"sourceRoot":""}